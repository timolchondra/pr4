#include "STOCKS_h.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/////////////////////////////////////////////////////////////////////////////////////////// 
///  Here we create the stock ADT. That takes a file pointer and does all the magic     ///
///  required of us in the specs for the assignment.                                    /// 
///////////////////////////////////////////////////////////////////////////////////////////


Stock createStock(FILE *stocksPTR) {

  Stock stock = malloc(sizeof(struct stocks_type));
  
  stock -> symbol = malloc(sizeof(char) * 6);

  fscanf(stocksPTR,"\n%[^ ,] ,%lf", stock->symbol, &stock->price);
  
  stock->symbol[strlen(stock->symbol)] = '\0';

  return stock;
  
}

///////////////////////////////////////////////////////////////////////////////////////////
///   This destroys the stock                                                           ///
///////////////////////////////////////////////////////////////////////////////////////////

void destroyStock(Stock stock) {

  free(stock -> symbol);
}

///////////////////////////////////////////////////////////////////////////////////////////
///   This gets the stock symbol                                                        ///
///////////////////////////////////////////////////////////////////////////////////////////

char* getSymbol(Stock stock) {

  return stock->symbol;
  
}

///////////////////////////////////////////////////////////////////////////////////////////
///   This gets the stock price                                                         ///
///////////////////////////////////////////////////////////////////////////////////////////

double getPrice(Stock stock) {

  return stock -> price;
  
}


///////////////////////////////////////////////////////////////////////////////////////////
///   This sets the stock symbol                                                        ///
///////////////////////////////////////////////////////////////////////////////////////////


void setSymbol(Stock stock, char* newSymbol) {

  strcpy(stock -> symbol, newSymbol);
  
}

///////////////////////////////////////////////////////////////////////////////////////////
///   This sets the stock price                                                         ///
///////////////////////////////////////////////////////////////////////////////////////////

void setPrice(Stock stock, double newPrice) {

  stock -> price = newPrice;
  
}

///////////////////////////////////////////////////////////////////////////////////////////
///   This prints the stock                                                             ///
///////////////////////////////////////////////////////////////////////////////////////////

void printStock(Stock stock) {

  printf("%s %.2lf\n", stock->symbol,  stock->price);

}

///////////////////////////////////////////////////////////////////////////////////////////
///   This compares the stock symbols                                                   ///
///////////////////////////////////////////////////////////////////////////////////////////

int compareSymbol(Stock stock1, Stock stock2) {

  return strcmp(stock1->symbol,stock2->symbol);

}

///////////////////////////////////////////////////////////////////////////////////////////
///   This prints to the file                                                           ///
///////////////////////////////////////////////////////////////////////////////////////////

void fprintStockPrice(FILE *fptr, Stock stock) {

  fprintf(fptr, "%.2lf,\n,", stock->price); 
  
}
